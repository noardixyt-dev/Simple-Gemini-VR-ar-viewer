<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Pro VIO Stereo AR</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <style>
        body { margin: 0; background: #000; color: #00e5ff; font-family: sans-serif; }
        #gui { position: fixed; inset: 0; z-index: 999; display: flex; flex-direction: column; align-items: center; justify-content: center; background: rgba(0,0,0,0.9); }
        .btn { background: #00e5ff; color: #000; border: none; padding: 20px 40px; font-size: 1.2rem; font-weight: bold; border-radius: 50px; cursor: pointer; margin: 10px; }
        #file-label { border: 2px dashed #00e5ff; padding: 20px; border-radius: 10px; margin: 20px; cursor: pointer; }
        input[type="file"] { display: none; }
    </style>
</head>
<body>

    <div id="gui">
        <h1>6DoF STEREO AR</h1>
        
        <label id="file-label" for="file-upload">
            <span>üìÅ UPLOAD .GLB MODEL</span>
            <input type="file" id="file-upload" accept=".glb,.gltf">
        </label>
        <p id="status">Ready to initialize...</p>

        <button class="btn" onclick="enterAR()">START IMMERSIVE AR</button>
    </div>

    <a-scene webxr="optionalFeatures: hit-test, local-floor; referenceSpaceType: local-floor">
        <a-assets id="assets"></a-assets>

        <a-entity id="model-container" position="0 0 -2" scale="1 1 1" visible="false"></a-entity>

        <a-camera position="0 1.6 0"></a-camera>
        <a-light type="ambient" intensity="1"></a-light>
        <a-light type="directional" position="1 2 1"></a-light>
    </a-scene>

    <script>
        const fileInput = document.getElementById('file-upload');
        const modelContainer = document.getElementById('model-container');
        const statusText = document.getElementById('status');

        // Handle File Import
        fileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                const url = URL.createObjectURL(file);
                modelContainer.setAttribute('gltf-model', `url(${url})`);
                modelContainer.setAttribute('visible', 'true');
                statusText.innerText = "Model Loaded: " + file.name;
            }
        });

        function enterAR() {
            const scene = document.querySelector('a-scene');
            
            // This is the "Magic" command. 
            // It tells the phone to start tracking the floor and world.
            scene.enterVR(); 

            // Hide the UI
            document.getElementById('gui').style.display = 'none';

            // IMPORTANT: To see the camera feed, we must make the background transparent
            // WebXR AR mode handles the camera passthrough automatically.
            scene.setAttribute('background', 'transparent: true');
        }
    </script>
</body>
</html>
